---
title: "data 401 p1"
author: "Casey Ng"
date: "10/3/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(car)
library(tidyverse)
```

```{r}
urlfile <- 'https://raw.githubusercontent.com/cng27/DATA401_Project1/main/fastfood.csv'
data <- read.csv(urlfile)

head(data)
```



```{r}
q2 <- data
q2['wagediff'] <- (q2$wagest2 - q2$wagest)
keeps <- c('wagediff', 'prpblck', 'crmrte', 'state', 'prppov', 'prpncar', 'income',
           'county', 'density', 'hseval')
q2_keep <- q2[keeps]

```


```{r}
for (i in 1:length(keeps)) {
  dist <- hist(q2_keep[,i], main=str_c("Histogram of ", keeps[i]), xlab=keeps[i])
  print(dist)
}
```


```{r}
causal_model = lm(wagediff ~ ., data=q2_keep)
summary(causal_model)
```


```{r}
par(mfcol=c(2,2))
qqPlot(rstudent(causal_model),pch=16)
hist(rstudent(causal_model),main="")
residualPlots(causal_model,type="rstudent",terms=~1,quadratic=FALSE,pch=16)
plot(rstudent(causal_model),type="o",pch=16)
abline(h=0,lty="dashed")
par(mfcol=c(1,1))
```

```{r}
for (i in 2:length(keeps)) {
  dist <- scatter.smooth(q2_keep[,i],q2_keep[,1], xlab = keeps[i], ylab = keeps[1])
  print(dist)
}
```





